version: 2.1
jobs:
  build:
    docker:
      - image: centos:latest #ubuntu:latest #circleci/python:latest note that this is Debian
    steps:
      - checkout
      - run:
          name: Update OS and Install packages
          command: |
            yum -y update
            yum -y install epel-release
            yum -y install python-pip
      - run:
          name: Install Ionic SDK
          command: |
            pip install --upgrade pip
            pip install ionicsdk
            pip show ionicsdk
      - run: 
          name: Canary
          command: |
            cat /etc/redhat-release
            python -V 
      # wait for python3 will need more than just this: yum -y install python36u
      # See https://www.digitalocean.com/community/tutorials/how-to-install-python-3-and-set-up-a-local-programming-environment-on-centos-7
      # for ubuntu OS ID: cat /etc/issue
      - run:
          name: Before Python Testing
          command: |
            export IONIC_PERSISTOR_PASSWORD='my secret password'
            mkdir ../.ionicsecurity
            cp sample-data/persistors/sample-persistor.pw ../.ionicsecurity/persistor.pw
      # navigation is not persistant between -run commands... file handling is
      - run:
          name: initialize-agent-with-password-persistor
          command: |
            cd python/initialize-agent-with-password-persistor
            python main.py
      - run:
          name: get-key
          command: |
            export IONIC_PERSISTOR_PASSWORD='my secret password'
            cd python/get-key
            python main.py
      - run:
          name: crypto-chunk-cipher
          command: |
            cd python/crypto-chunk-cipher
            python main.py
